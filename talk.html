<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Raleway);
      @import url(https://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Raleway'; }
      h1, h2, h3 {
        font-family: 'PT Serif';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
  </head>
  <body>
    <textarea id="source">

      layout: true

      ---

      class: center, middle
      background-image: url(https://i.imgur.com/HxDCfxI.png)
      background-size: cover;

      # Measuring Chronic Pain Outcomes with Ruby and Twilio

      <!-- .left[![ruby](https://i.imgur.com/HxDCfxI.png)]
      .right[![twilio](https://rebornix.gallerycdn.vsassets.io/extensions/rebornix/ruby/0.17.0/1520198344144/Microsoft.VisualStudio.Services.Icons.Default)] -->
      ---

      # In order:

      1. Lay out a non-business 'problem' through a story

      --

      2. Discuss attacking that problem with the help of 'Ruby' üçñ

      --

      3. Cover outcomes and retrospective observations

      --

      4. Underline the importance of using your Ruby 'superpower' ‚ù§Ô∏è

      ---

      # Who am I?

      ---
      background-image: url(https://media-cdn.tripadvisor.com/media/photo-s/0f/b3/68/f8/vista-view.jpg)
      # I used to live here

      ---
      background-image: url(http://www.opc-cornwall.org/Par_new/l_m/photos/lostwithiel1.jpg)
      # Now I live here

      ---

      # And I work here

      .center[![This is my image](https://pbs.twimg.com/profile_images/1122058292/ohq_avatar_400x400.jpg)]

      ---

      # Where I do this

      .center[![If you are seeing this text everything has gone horribly wrong.](http://plenglish.com/images/2017/diciembre/17/barcos.jpg)]

      ---
      class: center, middle
      # Today's talk has nothing to do about where I work.

      --
      .center[![image of laura and I](https://i.imgur.com/nEKCRhY.jpg)]

      ---

      # 1. The problem

      ---

      # Summer 2017

      --

      class: center, middle
      # ü§ï üöë

      ---

      # What is Avascular Necrosis?

      .center[![This is my image](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQjCsNCxbPCoyFQg6bc3e9Hx_dDptogJSe4oCaH0zSrgOQpig0YzQ)]

      ---

      .center[# ‚ùóÔ∏è]

      ???

      Dr. Said that the pressure swings will affect joint pain.

      ---

      class: center, middle
      # ‚ùì
      # ü§î

      ???

      My hypothesis

      --
      .left[# Pain: nearly unpredictable]
      --
      .left[# Pressure systems: very predictable]
      ---
      class: center, middle
      # Sit down at the negotiating table
      # üòº üòà

      ???

      Striking a deal with laura. It's all about compromise.

      ---

      # She would help me track and measure her pain üìà ‚úîÔ∏è

      --

      # I would start counting my caloric intake every day üò± üç™

      ---
      class: center, middle
      # 2. Solving this problem, with the aid of Ruby & Twilio

      --

      # Goal: extract as many data points with live pressure and pain readings as possible for processing at the end of the process.

      ---

      # Setting up the Twilio Interface
      .center[# üëÄ]

      ???

      Twilio Chunk, talk about why twilio
      ---

      # A web UI for this application was out of scope.

      ---

      # DISCLAIMER:
      --
      .center[## I am NOT a Twilio API expert or genius-]
      --
      .center[## That's the point.]
      ---

      # Twilio has some of the most out-of-the-box Ruby-Friendly documentation I have ever seen

      .center[![Twilio](https://i.imgur.com/PUjILMT.png)]

      ???

      That's how I was able to go from basically no Twilio experience at all, to spinning up a fully functioning Rails app.
      ---

      # Fast setup - focus on the actual problem at hand and not the integration.
      --
      ##¬†Sign up, get your number, get your API Keys, get started
      --
      ```ruby
      # Taken directly from twilio documentation
      require 'twilio-ruby'

      account_sid = "ACXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" # Your Account SID from www.twilio.com/console
      auth_token = "your_auth_token"   # Your Auth Token from www.twilio.com/console

      @client = Twilio::REST::Client.new account_sid, auth_token
      message = @client.messages.create(
          body: "Hello from Ruby",
          to: "+12345678901",    # Replace with your phone number
          from: "+12345678901")  # Replace with your Twilio number

      puts message.sid
      ```

      ---

      # Additional considerations for Rails...

      ---
      # Weather Underground

      .center[![wu-logo](https://i.imgur.com/u1T8vO4.png)]

      ---
      ## sdague/weather-underground.rb

      .center[![wu-gem](https://i.imgur.com/LiN8KWL.png)]

      ---

      # Side note - units of measure for barometric pressure:

      * SI: 101kPa (1 pascal = 1 newton per square metre, 1 N/m2)
      * USA: 15psi
      * Inches of Mercury: 29.53"
      * Millibars: 1013.25 mbar ü§î
      * Atm: 1

      ---

      .center[# Rails Backend - deployed on Heroku]

      ???

      Data modeling chunk

      ---

      # Simple object

      ```ruby
      #<DataPoint:0x00000005e89a18> {
                           :id => 115,
          :barometric_pressure => 1014.56146291907,
                   :pain_level => 4.0,
                   :created_at => Sun, 17 Sep 2017 10:26:31 UTC +00:00,
                   :updated_at => Sun, 17 Sep 2017 10:26:31 UTC +00:00
      }
      ```

      ---

      # Simple object

      ```ruby
      #<DataPoint:0x00000005e89a18> {
                           :id => 115,
          :barometric_pressure => 1014.56146291907, # <---- What I really care about
                   :pain_level => 4.0,              # <----
                   :created_at => Sun, 17 Sep 2017 10:26:31 UTC +00:00,
                   :updated_at => Sun, 17 Sep 2017 10:26:31 UTC +00:00
      }
      ```

      ---

      # Learning to interact with the user, the most difficult part

      ---

      # The core flow:

      * Random messaging 5x/day ‚úâÔ∏è
      * Capture pain reading üìà
      * Marry reading to live barometric pressure üå™
      * Handle as many edge cases as possible üò∞

      ???

      Explain the randomness of the flow with a rake task here.

      ---

      class: center, middle
      # Unexpected user inputs
      --
      .left[* `'F OFF'`]
      ---
      class: center, middle
      # Unexpected user inputs
      .left[* `'F OFF'.to_i == 0`]
      --
      ```ruby
      if invalid_entry_response
        "Huh. Okay. Well, #{pain_level} is not going to get recorded in this system. You know I have the power to text nick with what you are saying if you are TOO naughty."
      ```
      --
      .left[* `66`]
      --
      .left[* Inline adjustments, and retrospective data analysis adjustments]

      ???

      Some things were dealt with with inline realtime improvements and some with data sanitizing at the end.

      ---

      class: center, middle
      # Encourage user input

      ---
      class: center, middle
      ## Ensure that the response was sensitive to the situation

      #¬†Giphy integration

      .center[![You better not see this text](https://gph.is/1aPAh1Z)]
      ---

      ## Hook up response
      ```ruby
      type = ['funny', 'cat', 'dancing'].sample
      gif = RestClient.get("https://api.giphy.com/v1/gifs/search?api_key=#{api_key}=#{type}&limit=25&offset=0&rating=G&lang=en")
      selector = (0..23).to_a.sample
      "Saved! #{JSON.parse(gif)['data'][selector]['bitly_gif_url']}"
      ```

      [!catgif](images/cat.gif)

      ---

      ## Ensure that the response was sensitive to the situation

      ```ruby
      if pain_level.to_f >= 7.0
        painful_message
        # Note: Gifs were *never* appropriate on high-pain days.
      elsif pain_level.to_f < 4.0
        [less_pain_message, gif_message].sample
      else
        [middle_pain_message, gif_message].sample
      end
      ```

      ---
      # Light hearted on the easier days

      ```ruby
      def less_pain_message
        [
          'Successfully saved. Thanks for putting up with this app, it means a lot to nick',
          'Data has been logged. Wow, we are gonna have a good chunk of data points!',
          'Saved. You probably think this is all a bunch of random messages nick entered. NOPE! I\'m real! I live inside your phone! help!',
          'Saved! Hope that your pain levels stay low bee bop!',
          'Saved- fingers crossed your numbers stay good',
          'Boom! Loving those low numbers. Hope it stays low!',
          'Got it saved. Wonder if the pressure is working in your favor?'
        ].sample
      end
      ```
      ---
      # Light hearted on the easier days

      ```ruby
      def less_pain_message
        [
          'Successfully saved. Thanks for putting up with this app, it means a lot to nick',
          'Data has been logged. Wow, we are gonna have a good chunk of data points!',
          'Saved. You probably think this is all a bunch of random messages nick entered. NOPE! I\'m real! I live inside your phone! help!',
          # ^^^^ My favorite üôÇ
          'Saved! Hope that your pain levels stay low bee bop!',
          'Saved- fingers crossed your numbers stay good',
          'Boom! Loving those low numbers. Hope it stays low!',
          'Got it saved. Wonder if the pressure is working in your favor?'
        ].sample
      end
      ```
      ---

      # Support on the rough days

      ```ruby
      def painful_message
        ['This saved, but honey are you okay? Tell nick you just wanna chill tonight.',
          'I have got this in the system. Sorry you are hurting :(',
          'Saved successfully. I hope you are not fed up with this app, just know that the information you provide could be really, really helpful.',
          'Logged! Fingers crossed that these numbers will go down after the surgery...',
          'Saved. Thank you for being so good about sending this data in...',
          'Got it. Be sure to take it easy and not push yourself if you are sore!',
          'You should take a night off on the couch and make nick cook and clean and get you lots of tea. Modern Family night?'
        ].sample
      end
      ```
      ---
      class: center, middle
      # 3. Outcomes and retrospectives
      ---
      class: center, middle
      # How we view pain

      .left[* Pain is incredibly subjective]
      .left[* Hospital stay tried to make it objective]
      .left[* Laura had become *very* good at monitoring pain to her standard]
      .left[* !>5? no relief for you]
      .left[* Adjustment for the race to the top]

      ---

      class: center, middle
      # Making things mobile

      .left[* Since we traveled very little during this time, I would manually reset the coordinates when we visited family elsewhere, etc]
      .left[* This would benefit from location tracking which I was reluctant to do, and wouldn't want to build a native app just to have that]

      ---
      class: center, middle
      # How do we best process this information?

      ---

      # Dump information into a two dimensional array

      ```ruby
      def valid_readings(pain_level)
        pain_level > 0.0 && pain_level < 10.0
      end

      array = []
      DataPoint.all.each do |dp|
        array << [dp.barometric_pressure, dp.pain_level] if valid_readings(dp.pain_level)
      end
      ```
      ---

      # Write to CSV to share outside of the programming community

      ```ruby
      require 'csv'
      CSV.open("laura_stats.csv", "w") do |csv|
        array.map{|row| csv << row}
      end
      ```
      ---

      # Visualize with a Graph

      .center[![graph](https://i.imgur.com/dm7Sp4M.png)]

      ---

      # What is an SVM?

      definition
      ---

      ## This is where I left off

      ---
      class: center, middle
      # 4. Using our superpower, for good

      ---
      class: center, middle
      ## It's not a choice between 'working for the man' and 'toy projects'
      ## Not everyone can do what you do
      ## What is a few minutes of mindless scripting for you may be life changing for someone else
      ## Your gift was not just to argue with fellow employees over antipatterns on PRs

      ---

      # Wrapup:

      1. Lay out a non-business 'problem' through a story
      2. Discuss attacking that problem with the help of 'Ruby' üçñ
      3. Cover outcomes and retrospective observations
      4. Underline the importance of using your Ruby 'superpower' ‚ù§Ô∏è

      ---

      # Thanks for your time!

      ## schwad.github.io (slides will be published here)
      ## @schwad4hd14 (twitter)
      ## github.com/schwad
      ## nicholas.schwaderer@gmail.com

      ---


      # END

      To be deleted

      ---

      ##¬†GOAL: forecasting someday
      ##¬†setting up the app
      ## Do a slide about hospital stay before THEN do machine learning

      ---

      ## Reformatting the iterations with regards to messaging user (3-4 slides of code)

      ## Setting up things for machine learning (3-4 slides, include original blog that inspired me and show code)

      ## The final run through (3-4 slides to get results working)

      ## Final conclusions only 24% going together

      ## However, never under a 4 under x

      ---

      # GENERAL RESOURCES FOR SELF

      --> styling remark


      --> code notes

      ---

      # show images correctly
      # correct formatting
      # improve style?
      # practice with it, rearrange as needed

      ---

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({
        slideNumberFormat: ''
      });
    </script>
  </body>
</html>
